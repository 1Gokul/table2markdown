$(document).ready(function(){$("#excel-generate-button").on("click",function(){if($("#input-excel").val().length){$("#excel-generate-button").prop("disabled",!0),$(".alert, .converting-notif").remove(),$('<span class="lead mx-lg-3 float-lg-right mx-sm-auto my-2 converting-notif">Converting...<i class="fas fa-circle-notch fa-spin ml-2"></i></span>').appendTo(".error-message-box").hide().fadeIn(300);let e=JSON.stringify($("#input-excel").val());$.ajax({type:"POST",url:Flask.url_for("convert_excel_table"),data:e,processData:!1,contentType:"application/json;charset=UTF-8"}).done(e=>{$("#excel-generate-button").prop("disabled",!1),$(".converting-notif").remove(),$('<span class="lead mx-lg-3 float-lg-right mx-sm-auto my-2 converting-notif">Complete!<i class="far fa-check-circle ml-2"></i></span>').appendTo(".error-message-box").hide().fadeIn(300),function(e){$("#result-container").remove(),$("#result-rule").remove();var l='<hr id="result-rule" size="2" width="100%" align="center" noshade>';l+='<div id="result-container" class="result-container"><h1>Your converted table</h1>',l+='<div class="card result-box mt-5"><div class="grid-child result-text darkerbg">'+e.resultTable+"</div>",l+='<div class="grid-child links"><a href="'+Flask.url_for("get_table",{view_type:"raw",file_id:e.resultFileID})+'"target="_blank" class="btn submit-download-link">Raw</a>',l+='<a href="'+Flask.url_for("get_table",{view_type:"download",file_id:e.resultFileID})+'"target="_blank" class="btn submit-download-link">Download</a></div></div></div>',$(l).insertAfter(".excel-paste-container"),window.scrollTo(0,$("hr").offset().top)}(e)}).fail(e=>{console.log("Error during file convert: "+e)})}else $(".alert, .converting-notif").remove(),$('<div class="alert alert-danger my-0" role="alert">Kindly paste an Excel table.</div>').appendTo(".error-message-box").hide().fadeIn(300)})});