$(document).ready(function(){function e(e,t){$(".alert").remove(),$('<div type="hidden" class="alert alert-'+t+'" role="alert">'+e+"</div>").insertBefore(".custom-file").hide(),$(".alert").fadeIn(400)}$(".custom-file-input").on("change",function(){var t=$(this).val().split("\\").pop();$(this).siblings(".custom-file-label").addClass("selected").html(t);var l=$(".custom-file-input").val().split("/").pop().split(".")[1];$.inArray(l,["csv"])<0?(e("Kindly select a CSV file.","danger"),$("#submit-button").prop("disabled",!0)):$("#csvFile").prop("files")[0].size>10485760?(e("This file is larger than the 10MB limit! Please select a smaller one.","danger"),$("#submit-button").prop("disabled",!0)):($(".alert").length&&e("Nice, this one's good to go!","primary"),$("#submit-button").prop("disabled",!1))}),$("#submit-button").on("click",function(){var t=$("input[name=modify-or-not]:checked","#csv-form").val();if(t){$(this).prop("disabled",!0).html('Converting...<i class="fas fa-circle-notch fa-spin ml-2"></i>'),$(".custom-file-input, input[name=modify-or-not]").prop("disabled",!0);var l=$("#csvFile").prop("files")[0];Papa.parse(l,{complete:function(e){console.log("Finished:",e.data),function(e,t){$.ajax({type:"POST",url:Flask.url_for("convert_csv_file"),data:JSON.stringify({data:e,convertOption:t}),processData:!1,contentType:"application/json;charset=UTF-8"}).done(e=>{if($("#submit-button").html('Complete!<i class="far fa-check-circle ml-2">'),"modify-false"===t)!function(e){$("#result-container").remove(),$("#result-rule").remove();var t='<hr id="result-rule" size="2" width="100%" align="center" noshade>';t+='<div id="result-container" class="result-container"><h1>Your converted table</h1>',t+='<div class="card result-box mt-5"><div class="grid-child result-text darkerbg">'+e.resultTable+"</div>",t+='<div class="grid-child links"><a href="'+Flask.url_for("get_table",{view_type:"raw",file_id:e.resultFileID})+'"target="_blank" class="btn submit-download-link">Raw</a>',t+='<a href="'+Flask.url_for("get_table",{view_type:"download",file_id:e.resultFileID})+'"target="_blank" class="btn submit-download-link">Download</a></div></div></div>',$(t).insertAfter(".csv-upload-container"),window.scrollTo(0,$("hr").offset().top)}(e);else{var l='<a href="'+Flask.url_for("insert_and_convert",{operation:"edit-csv",file_id:e.resultFileID})+'" class="btn submit-download-link">Proceed to Edit<i class="fas fa-external-link-alt mx-2"></i></a>';$(l).insertAfter("#submit-button")}}).fail(e=>{console.log("Error during file convert: "+e)})}(e.data,t)}})}else e("Kindly select one of the options below.","danger"),$(".form-check-label").addClass("border-bottom border-danger")})});